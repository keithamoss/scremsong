language: node_js
node_js:
- '9'
env:
  # Stop warnings causing build failures.
  # - CI=false REACT_APP_GOOGLE_MAPS_API_KEY=AIzaSyBuOuavKmg0pKmdGEPdugThfnKQ7v1sSH0 REACT_APP_GOOGLE_ANALYTICS_UA=UA-48888573-1 REACT_APP_MAPBOX_API_KEY=pk.eyJ1Ijoia2VpdGhtb3NzIiwiYSI6IjkxMTViNjcxN2U5ZDBjMTYzYzY2MzQwNTJkZjM1NGFkIn0.HS40UI-OD5lQWBxUCZOwZg REACT_APP_RAVEN_URL=https://8d31580cc3314ca0812ff9d72c4d996f@sentry.io/291819
  - secure: "NlqKadgHM3c20f5ZxY2TZUbL8XELojoRJLld0q8+HzIGRHX9y89y0ls8JSOQoLaMvZxlRvX7Bqtnz7LVq05hvfOgAha23ytZKsNqa142gdwVah6O874tvco546PvLhtkjWUf6R2JQk+yaypn4zytjPKk06uKqtxPb1RElARimY2Jwt+kDHdcHiM30EkMaGssbz1CjCFPNY6bhp9dG6OL3aMbY0WkGL/kmh+2MpnhYoKWc7mNRHpi7FxqFK1YTIb9QVJii39AaIlSfQ47Ot6bQed4kFyABPkxV4zNNzglHhKpcT/S6o8b6CAe6e8yED2bse5qbTXsFRPRMjjLyjh90eJZY21GN9wRGmlf50AnyWizY3+fwrIKcYl+pqdtTSiz2TJcdszb9WxMnQL+vv/wuPlVwOY41u1jlByI3Zva6QW9sDwVAqhnAivWtAlW2ebGteL9BnnI5ZG7FVu8VuG9f7M5W4V5QYWEtPHzmjjjGIA13cV3ShvGZS4n/q4kzq99RMIlTT2BxH4fkINO/2LR5OrNzg+AyBsRoQrXiZhn8aeKE13bC7AsPEUowTUTsfsDa+voOP6DY6BWLETS86ucPCI8po4ASA2Kbe/HM6tqKtadxu3lS/i45SRPHnOdVdIkJthyx5pGdcKDsv9JstnkEzckTsv9FSb9lX1diBrn+Fs="
# before_script:
#   - echo -e "deb https://s3.amazonaws.com/repo.deb.cyberduck.io stable main" | sudo tee /etc/apt/sources.list.d/cyberduck.list > /dev/null
#   - sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys FE7097963FEFBE72
#   - sudo apt-get update
#   - sudo apt-get install duck
script:
  - pwd
  - echo -n $travis_digitalocean_{00..30} >> ~/.ssh/travis_digitalocean_base64
  - base64 --decode --ignore-garbage ~/.ssh/travis_digitalocean_base64 > ~/.ssh/travis_digitalocean
  - chmod 600 ~/.ssh/travis_digitalocean
  - echo -e "Host github.com\n\tStrictHostKeyChecking no\n" >> ~/.ssh/config
  - ls ~/.ssh/
  - scp -i ~/.ssh/travis_digitalocean -rp root@209.97.166.142:/scremsong/app/build/ ./
  - ls
  # - duck --username $FTP_USERNAME --password $FTP_PASSWORD --assumeyes --nokeychain --synchronize $FTP_PATH $TRAVIS_BUILD_DIR/backend/ --existing upload --parallel 6
  # - cd app
  # - npm install .
  # - npm run build
  # - cd ../
# deploy:
#   - provider: s3
#     access_key_id: $AWS_ACCESS_KEY_ID
#     secret_access_key: $AWS_SECRET_ACCESS_KEY
#     region: $AWS_DEFAULT_REGION
#     bucket: scremsong.democracysausage.org
#     skip_cleanup: true
#     local_dir: app/build
#     cache_control: "no-cache"
#     on:
#       branch: master
# after_deploy:
#   - if [ "$TRAVIS_BRANCH" == "master" ]; then curl --verbose -X DELETE "https://api.cloudflare.com/client/v4/zones/$CF_ZONE_ID/purge_cache" -H "X-Auth-Email:$CF_EMAIL" -H "X-Auth-Key:$CF_API_KEY" -H "Content-Type:application/json" --data '{"purge_everything":true}'; fi